<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Report</title>
  <link rel="stylesheet" href="emp-report.css" />
  <link rel="stylesheet" href="emp-footer.css" />
</head>
<body>
  <div class="report glass">
    <h2>Send Report</h2>
    <input type="text" id="title" placeholder="Title" />
    <textarea id="details" placeholder="Write your report here..."></textarea>
    <button onclick="sendReport()">Send</button>
  </div>
  
<footer class="admin-footer">
  <div class="footer-row" id="mainNav">
    <div class="footer-icon" onclick="navigateTo('dashboard.html')">
      <span>ğŸ </span>
      <p>Dashboard</p>
    </div>
    <div class="footer-icon" onclick="navigateTo('summary.html')">
      <span>ğŸ“¦</span>
      <p>Summary</p>
    </div>
    <div class="footer-icon" onclick="navigateTo('transaction.html')">
      <span>ğŸ§¾</span>
      <p>Transactions</p>
    </div>
    <div class="footer-icon" id="toggleExpand">
      <span>ğŸ”¼</span>
      <p>More</p>
    </div>
  </div>

  <div class="footer-row hidden" id="extraNav">
    <div class="footer-icon" onclick="navigateTo('report.html')">
      <span>ğŸ“©</span>
      <p>Reports</p>
    </div>
    <!-- Add more options here or leave blank -->
    <div class="footer-icon empty"></div>
    <div class="footer-icon empty"></div>
    <div class="footer-icon empty"></div>
  </div>
</footer>

<script type="module">
  import { db, collection, doc, setDoc, auth, serverTimestamp } from './firebase.js';

  async function sendReport() {
    const titleInput = document.getElementById('title');
    const detailsInput = document.getElementById('details');
    const button = document.querySelector("button");

    const title = titleInput.value.trim();
    const details = detailsInput.value.trim();

    if (!title || !details) {
      alert("Please fill in both the title and report details.");
      return;
    }

    button.disabled = true;
    button.textContent = "Sending...";

    try {
      await setDoc(doc(collection(db, 'reports')), {
        title,
        details,
        employee: auth.currentUser.uid,
        time: serverTimestamp()
      });

      alert("Report submitted successfully.");
      location.href = 'employee_dashboard.html';
    } catch (error) {
      console.error("Failed to submit report:", error);
      alert("An error occurred while submitting the report. Please try again.");
      button.disabled = false;
      button.textContent = "Send";
    }
  }
</script>
  <script type="module" src="emp-footer.js"></script>
</body>
</html>